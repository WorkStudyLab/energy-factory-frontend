# 2025-10-01 작업 로그

## 🎯 오늘의 목표
- [x] 프로젝트 CI/CD 구축 및 S3 배포 완료
- [x] GitHub Actions 자동 배포 파이프라인 구축
- [x] AWS 보안 설정 (IAM 최소 권한)
- [x] CORS 이슈 해결

## 📋 작업 내용

### 구현 완료
- ✅ **프로젝트 현황 분석**: React + Vite + TypeScript 구조 파악
- ✅ **S3 버킷 생성**: `energy-factory-frontend-20251001` 정적 웹 호스팅
- ✅ **환경변수 설정**: `.env` 파일 생성 및 API URL 설정
- ✅ **수동 배포 테스트**: AWS Console을 통한 첫 배포 성공
- ✅ **CORS 설정**: Spring Boot 백엔드에 S3 도메인 허용 추가
- ✅ **IAM 사용자 생성**: `github-actions-s3-deploy` 최소 권한 계정
- ✅ **GitHub Actions 워크플로우**: `.github/workflows/deploy.yml` 작성
- ✅ **GitHub Secrets 설정**: AWS 인증 정보 및 환경변수 등록
- ✅ **CI/CD 테스트**: 자동 빌드 및 배포 파이프라인 성공

### 진행 중
- 🔄 문서 정리 (현재 작업)

### 이슈/블로커
- ❌ **초기 CORS 오류**: S3 도메인이 백엔드에서 허용되지 않음
  - **해결**: Spring Boot CORS 설정에 S3 URL 추가
- ❌ **AWS CLI 미설치**: 로컬에 aws cli 없어서 수동 업로드 진행
  - **해결**: AWS Console 사용, 향후 AWS CLI 설치 예정

## 💡 학습 내용
- **S3 정적 웹 호스팅**: 버킷 정책과 퍼블릭 액세스 설정의 중요성
- **SPA 라우팅**: 오류 문서를 index.html로 설정하여 클라이언트 라우팅 지원
- **IAM 최소 권한 원칙**: 보안을 위해 특정 S3 버킷만 접근 가능한 사용자 생성
- **GitHub Actions Secrets**: 민감한 정보를 안전하게 CI/CD에서 사용하는 방법
- **Vite 환경변수**: `VITE_` 접두사로 클라이언트에서 접근 가능한 환경변수 설정

## 📈 다음 작업 계획
- CloudFront CDN 설정으로 성능 향상
- 번들 사이즈 최적화 (코드 스플리팅)
- HTTPS 적용 (SSL 인증서)
- 스테이징 환경 구축
- AWS CLI 설치 및 로컬 배포 스크립트 작성

## 📊 커밋/PR 링크
- [8bd189c] feat: Add GitHub Actions CI/CD workflow for S3 deployment

## 🔧 주요 해결 과정

### 1. S3 버킷 설정 (14:00-15:00)
```
1. 버킷 생성 (퍼블릭 액세스 허용)
2. 정적 웹 호스팅 활성화
3. 버킷 정책 JSON 설정
4. 수동 파일 업로드 테스트
```

### 2. CORS 이슈 해결 (15:30-16:00)
```
문제: 브라우저에서 API 호출 시 CORS 차단
해결: EC2 Spring Boot에 S3 도메인 허용 설정 추가
```

### 3. GitHub Actions 구축 (16:30-18:00)
```
1. IAM 사용자 생성 및 S3 권한 설정
2. GitHub Secrets 등록
3. 워크플로우 YAML 작성
4. 자동 배포 테스트 성공
```

## 📋 생성된 주요 파일
- `.github/workflows/deploy.yml` - CI/CD 파이프라인
- `.env` - 환경변수 설정
- `CI_CD_DEPLOYMENT_GUIDE.md` - 상세 배포 가이드 (루트에 잘못 생성, 삭제 예정)

## 🌐 배포 결과
- **프로덕션 URL**: http://energy-factory-frontend-20251001.s3-website.ap-northeast-2.amazonaws.com
- **배포 방식**: GitHub Actions (main 브랜치 push 시 자동)
- **빌드 시간**: 약 2-3분
- **상태**: ✅ 성공


## 🎯 성과 지표
- **자동화**: 수동 배포 → 자동 CI/CD 전환 완료
- **보안**: AWS 최소 권한 원칙 적용
- **안정성**: 빌드-테스트-배포 파이프라인 구축
- **문서화**: 상세 가이드 및 작업 로그 작성
